webpackJsonp([27],{h4Gk:function(t,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var a={name:"search",data:function(){return{placeholder:"电竞馆名称/地址",isDownLoading:!1,isUpLoading:!1,finished:!1,offsettop:0,page:0,keyword:"",city:"北京",lat:0,lng:0,recommend:0,label:"",district:"",circle:"",netlist:[],flag:!1,offset:0,total:0,slist:[],type:0,keywords:["电竞馆名称/地址","俱乐部名称/地址","酒店名称/地址"],cshow:!1,clublist:[],ind:0,page1:0,category_id:"",isUpLoading1:!1,isDownLoading1:!1,finished1:!1,offset1:0,finishedtext:"到底了",clublist1:[],page2:0,category_id2:"",isUpLoading2:!1,isDownLoading2:!1,finished2:!1,offset2:0,finishedtext2:"到底了",schoolshow:!1,inputH:0}},created:function(){var t=this;this.type=this.$route.query.type||0,this.placeholder=this.keywords[this.type],localStorage.user_twap&&this._SearchHistory(),this.$nextTick(function(){t.inputH=t.$refs.searchtop.offsetHeight}),this.position=JSON.parse(sessionStorage.pos),this.city=sessionStorage.wapcity||"北京"},methods:{seachAnswer:function(){this.page=0,this.isDownLoading=!1,this.isUpLoading=!1,this.finished=!1,this.isDownLoading1=!1,this.isUpLoading1=!1,this.finished1=!1,this.isDownLoading2=!1,this.isUpLoading2=!1,this.finished2=!1,this.keyword&&(0==this.type?(this.netlist=[],this._GetBarList()):1==this.type?(this.clublist=[],this._ClubIndex()):2==this.type&&(this.clublist1=[],this._CollegeIndex())),localStorage.user_twap&&this._SearchHistory()},keywordfn:function(t){this.keyword=t,this.seachAnswer()},_SearchHistory:function(){var t=this;this.$api.SearchHistory(this.type).then(function(i){1==i.code&&(t.slist=i.data)})},_SearchClear:function(){var t=this;this.$api.SearchClear(this.type).then(function(i){1==i.code?(t.$com.showtoast("清除成功！"),t.slist=[]):t.$com.showtoast(i.msg)})},backindex:function(){this.$router.go(-1)},_GetBarList:function(){var t=this,i=this.page+1;this.$com.showtoast("加载中…","","",1e3,"",!1,!0),this.$api.GetBarList(i,this.keyword,this.city,this.position[0]||0,this.position[1]||0,this.recommend,this.label,0==this.lindex?"":this.district,this.circle).then(function(i){t.flag=!0,1==i.code&&(t.total=i.data.total,t.netlist.length?(t.isUpLoading&&(t.netlist=t.netlist.concat(i.data.data),t.$nextTick(function(){t.isUpLoading=!1}),i.data.data.length<10&&(t.finished=!0)),t.isDownLoading&&(t.isDownLoading=!1,t.netlist=i.data.data,t.finished&&(t.finished=!1))):t.netlist=i.data.data)})},onRefresh:function(){var t=this;setTimeout(function(){t.$com.showtoast("刷新成功"),t.isDownLoading=!1,t.page=0,t._GetBarList()},500)},onLoad:function(){this.page++,this.isUpLoading=!0,this._GetBarList()},godetail:function(t){this.$router.push({path:"/competitiondetail",query:{id:t}})},godetail1:function(t){this.$router.push({path:"/clubdetail",query:{club_id:t}})},_ClubIndex:function(){var t=this,i=this.page+1;this.$com.showtoast("加载中…","","",1e3,"",!1,!0),this.$api.ClubIndex(i,this.category_id,this.city,this.keyword).then(function(i){t.cshow=!0,1==i.code&&(t.total=i.data.total,t.clublist.length?(t.isUpLoading1&&(t.clublist=t.clublist.concat(i.data.data),t.$nextTick(function(){t.isUpLoading1=!1}),i.data.data.length<10&&(t.finished1=!0,t.finishedtext="到底了")),t.isDownLoading1&&(t.isDownLoading1=!1,t.clublist=i.data.data,t.finished1&&(t.finished1=!1))):(t.clublist=i.data.data,t.finishedtext="到底了"))})},onRefresh1:function(){var t=this;setTimeout(function(){t.$com.showtoast("刷新成功"),t.isDownLoading1=!1,t.clublist=[],t.page=0,t._ClubIndex()},500)},onLoad1:function(){this.page++,this.isUpLoading=!0,this._ClubIndex()},_CollegeIndex:function(){var t=this,i=this.page+1;this.$com.showtoast("加载中…","","",1e3,"",!1,!0),this.$api.CollegeIndex(i,this.category_id,this.city,this.district,this.circle,this.keyword).then(function(i){t.schoolshow=!0,1==i.code&&(t.total=i.data.total,t.clublist1.length?(t.isUpLoading2&&(t.clublist1=t.clublist1.concat(i.data.data),t.$nextTick(function(){t.isUpLoading2=!1}),i.data.data.length<10&&(t.finished2=!0,t.finishedtext="到底了")),t.isDownLoading2&&(t.isDownLoading2=!1,t.clublist1=i.data.data,t.finished2&&(t.finished2=!1))):(t.clublist1=i.data.data,t.finishedtext="到底了"))})},onRefresh2:function(){var t=this;setTimeout(function(){t.$com.showtoast("刷新成功"),t.isDownLoading=!1,t.page=0,t._CollegeIndex()},500)},onLoad2:function(){this.page++,this.isUpLoading=!0,this._CollegeIndex()},godetail2:function(t){this.$router.push({path:"/schooldetail",query:{college_id:t}})}}},e={render:function(){var t=this,i=t.$createElement,s=t._self._c||i;return s("div",{staticClass:"searchbox"},[s("van-sticky",[s("div",{ref:"searchtop",staticClass:"searchtop"},[s("van-icon",{attrs:{name:"arrow-left",tag:"span"},on:{click:t.backindex}}),t._v(" "),s("form",{staticClass:"search_input"},[s("van-icon",{attrs:{name:"search"}}),t._v(" "),s("van-field",{attrs:{type:"serch",placeholder:t.placeholder},on:{keyup:function(i){return!i.type.indexOf("key")&&t._k(i.keyCode,"enter",13,i.key,"Enter")?null:t.seachAnswer(i)}},model:{value:t.keyword,callback:function(i){t.keyword=i},expression:"keyword"}})],1),t._v(" "),t.keyword?s("van-button",{attrs:{size:"mini",type:"default",color:"transparent"},on:{click:t.seachAnswer}},[t._v("搜索\n            ")]):s("van-button",{attrs:{size:"mini",color:"transparent",type:"default"},on:{click:t.backindex}},[t._v("取消")])],1)]),t._v(" "),s("div",{staticClass:"search_his"},[t._m(0),t._v(" "),t.slist.length?s("div",{on:{click:t._SearchClear}},[s("span",{staticClass:"iconfont iconshanchu"}),t._v("清空")]):t._e()]),t._v(" "),t.slist.length?s("div",{staticClass:"hislist"},t._l(t.slist,function(i,a){return s("span",{key:a,on:{click:function(s){return t.keywordfn(i)}}},[t._v(t._s(i))])}),0):t._e(),t._v(" "),t.total>0?s("van-sticky",{attrs:{offset:t.inputH}},[s("div",{staticClass:"total"},[t._v("共"+t._s(t.total)+"条搜索记录")])]):t._e(),t._v(" "),t.flag&&t.netlist.length&&0==t.type?s("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isDownLoading,callback:function(i){t.isDownLoading=i},expression:"isDownLoading"}},[s("van-list",{staticClass:"clist",attrs:{finished:t.finished,offset:t.offset,"finished-text":"到底了"},on:{load:t.onLoad},model:{value:t.isUpLoading,callback:function(i){t.isUpLoading=i},expression:"isUpLoading"}},t._l(t.netlist,function(i,a){return s("div",{key:a,staticClass:"citem",on:{click:function(s){return t.godetail(i.id)}}},[s("div",{staticClass:"cimg"},[s("van-image",{attrs:{src:i.image,alt:""}}),t._v(" "),1==i.recommend?s("span",[t._v("推荐")]):t._e()],1),t._v(" "),s("div",{staticClass:"cright"},[s("div",{staticClass:"name single-line-text"},[t._v(t._s(i.name))]),t._v(" "),s("div",{staticClass:"cname"},[s("div",{staticClass:"namebox"},[s("div",{staticClass:"startbox"},t._l(parseInt(i.star),function(t){return s("span",{staticClass:"iconfont iconstar-fill"})}),0)]),t._v(" "),s("div",{staticClass:"juli"},[t._v(t._s(i.distance))])]),t._v(" "),s("div",{staticClass:"ctype"},t._l(i.label_ids,function(a){return s("span",{staticClass:"single-line-text",style:{maxWidth:1/i.label_ids.length*100+"%"}},[t._v(t._s(a))])}),0),t._v(" "),s("div",{staticClass:"caddress "},[s("van-icon",{attrs:{name:"location-o"}}),t._v(" "),s("span",{staticClass:"single-line-text"},[t._v(t._s(i.address))])],1)])])}),0)],1):t._e(),t._v(" "),t.flag&&0==t.netlist.length&&0==t.type?s("div",{staticClass:"clist"},[s("NoData",{staticClass:"nodata",attrs:{top:0,text:"暂无匹配的电竞馆"}})],1):t._e(),t._v(" "),t.cshow&&t.clublist.length&&1==t.type?s("van-pull-refresh",{on:{refresh:t.onRefresh1},model:{value:t.isDownLoading1,callback:function(i){t.isDownLoading1=i},expression:"isDownLoading1"}},[s("van-list",{staticClass:"jlist",attrs:{finished:t.finished1,offset:t.offset1,"finished-text":"到底了"},on:{load:t.onLoad1},model:{value:t.isUpLoading1,callback:function(i){t.isUpLoading1=i},expression:"isUpLoading1"}},t._l(t.clublist,function(i,a){return s("div",{key:i.id,staticClass:"jitem van-row--flex",on:{click:function(s){return t.godetail1(i.id)}}},[s("div",{staticClass:"jimg"},[s("van-image",{attrs:{src:i.image,alt:""}})],1),t._v(" "),s("div",{staticClass:"jright"},[s("div",{staticClass:"jname van-ellipsis"},[t._v(t._s(i.name))]),t._v(" "),s("div",{staticClass:"jinfo"},[s("span",{staticClass:"name"},[t._v(t._s(i.contact))]),s("span",{staticClass:"tel"},[t._v(t._s(i.contact_number))])]),t._v(" "),s("div",{staticClass:"jaddress van-ellipsis"},[t._v(t._s(i.address))])])])}),0)],1):t._e(),t._v(" "),t.cshow&&0==t.clublist.length&&1==t.type?s("div",{staticClass:"jlist"},[s("NoData",{attrs:{top:140,text:"暂无匹配的俱乐部"}})],1):t._e(),t._v(" "),t.schoolshow&&t.clublist1.length&&2==t.type?s("van-pull-refresh",{on:{refresh:t.onRefresh2},model:{value:t.isDownLoading2,callback:function(i){t.isDownLoading2=i},expression:"isDownLoading2"}},[s("van-list",{staticClass:"jlist",attrs:{finished:t.finished2,offset:t.offset2,"finished-text":t.finishedtext2},on:{load:t.onLoad2},model:{value:t.isUpLoading2,callback:function(i){t.isUpLoading2=i},expression:"isUpLoading2"}},t._l(t.clublist1,function(i,a){return s("div",{key:i.id,staticClass:"jitem van-row--flex",on:{click:function(s){return t.godetail2(i.id)}}},[s("div",{staticClass:"jimg"},[s("img",{attrs:{src:i.image,alt:""}})]),t._v(" "),s("div",{staticClass:"jright"},[s("div",{staticClass:"jname van-ellipsis"},[t._v(t._s(i.name))]),t._v(" "),s("div",{staticClass:"jinfo"},[s("span",{staticClass:"name"},[t._v(t._s(i.contact))]),s("span",{staticClass:"tel"},[t._v(t._s(i.contact_number))])]),t._v(" "),s("div",{staticClass:"jaddress van-ellipsis"},[t._v(t._s(i.address))])])])}),0)],1):t._e(),t._v(" "),t.schoolshow&&0==t.clublist.length&&2==t.type?s("div",{staticClass:"jlist"},[s("NoData",{staticClass:"nodata",attrs:{top:0,text:"暂无相关酒店"}})],1):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",[i("span",{staticClass:"iconfont icontime-circle"}),this._v("搜索历史")])}]};var n=s("VU/8")(a,e,!1,function(t){s("qDAk")},"data-v-6c5f83e0",null);i.default=n.exports},qDAk:function(t,i){}});